var _ = require('lodash');
var fs = require('fs');

var avgs = [
  {month: '2012-10', data: "carbon tax (2.16657), clean energy (1.7731059999999998), Attorney General (1.7105549999999998), carbon price (1.649441), mental health (1.2504709999999999), Senator Joyce (1.229702), Social Security (1.196108), community services (1.1602700000000001), Standing Committee (1.144835), Joint Committee (1.1170449999999998), carbon pricing (1.0554999999999999), New South Wales (0.982662), Papua New Guinea (0.9785600000000001), emissions trading (0.969022), Defence Force (0.8719969999999999), Higher Education (0.8482620000000001), National Broadband Network (0.8379810000000001), Defence Materiel Organisation (0.8218350000000001), Pay Equity (0.815007), intelligence and security committee (0.7848679999999999), Howard government (0.729471), higher education (0.72229), full time (0.68818), period 1 (0.664468), Higher Education Support Act 2003 (0.6393519999999999), Brandis (0.638911), Health Insurance (0.635942), dental health (0.592475), World Mental Health Day (0.540978), fair (0.525606), coalition (0.515411), Defence Minister (0.48284), Climate Change (0.470711), local government (0.463216), senator lyn allison (0.445626), mental illness (0.442364), Independent State (0.436843), Anti (0.434358), Human Rights Committee (0.434194), Energy Efficiency (0.432658), Customs (0.431226), Western Sydney (0.431016), parliamentary secretary (0.430449), health reform (0.427268), Foreign Affairs (0.427159), political question (0.42675), Defence Budget (0.425648), foreign affairs (0.425627), climate change (0.424853), Customs Tariff (0.420989)"},
  {month: '2012-09', data: "New South Wales (4.243614), Marriage Amendment (3.660974), Howard government (3.6516929999999994), carbon tax (3.634803), Environment Protection (3.522678), Standing Committee (3.3735700000000004), Joint Committee (3.14716), Senator Joyce (3.1427310000000004), environment minister (2.382599), carbon price (2.35123), first time (2.250467), Foreign Affairs (2.241174), asylum seekers (2.013623), Mr Hockey (2.009567), Government Whip (1.789274), Deputy Leader (1.77767), queensland government (1.7741159999999998), Lance Corporal (1.681734), this side (1.669309), fisheries (1.607743), coalition government (1.435862), Victorian government (1.429429), National Broadband Network (1.413675), Wong (1.3901189999999999), black hole (1.387994), Constitutional Affairs (1.360308), Local Government (1.358684), Defence Force (1.303209), Constitutional Affairs Committee (1.290568), charities (1.268769), coal seam gas (1.243408), parliamentary secretary (1.235479), emissions trading scheme (1.223747), carbon pricing (1.170291), Defence Minister (1.130015), Human Rights Committee (1.125562), Human Rights (1.125533), Digital Economy (1.110246), London Olympic Games (1.107636), research and development (1.087852), good question (1.0818050000000001), hizb ut tahrir (1.073522), Financial Services (1.065883), Price Point (1.042848), Government Spending (1.0403390000000001), Materiel (0.975098), public interest (0.968953), Nauru (0.9687840000000001), Kokoda Track (0.954102), Housing Minister (0.951919)"},
  {month: '2012-08', data: "carbon tax (5.451962), Senator Joyce (4.227955000000001), carbon pricing (3.9334589999999996), carbon price (3.606161), Standing Committee (3.2412829999999992), coalition (2.981084), Foreign Affairs (2.315365), asylum seekers (2.137756), climate change (2.104227), parliamentary secretary (1.7174850000000002), Murray Darling Basin (1.616627), Energy Efficiency (1.58274), cluster munitions (1.542424), Deputy Leader (1.532707), Local Government (1.473138), this side (1.4389850000000002), Wong (1.408243), electricity prices (1.3373789999999999), Howard government (1.329142), Attorney General (1.31009), National Broadband Network (1.224066), superannuation (1.222379), government ministers (1.20015), illegal logging (1.194712), Joint Committee (1.129247), Climate Change (1.117184), committees (1.09577), Carbon Pricing (1.084968), joint committee (1.08289), Disability Insurance (1.06665), New South Wales (1.058584), Price Point (1.052003), health insurance (1.0406339999999998), vietnam veteran (1.034217), workplace (1.01688), Mr Hockey (1.008732), intelligence and security committee (1.002668), Financial Services (0.9939709999999999), carbon (0.942989), defence budget (0.937902), Olympic Games (0.933554), Health Services Union (0.9191750000000001), BHP Billiton (0.91598), Marriage Amendment (0.905152), government investment (0.8919889999999999), policy (0.8798410000000001), Nauru (0.877522), human rights (0.869206), Brandis (0.867475), People Trafficking (0.819537)"}
]

_.each(avgs, function(avg){
  fs.writeFileSync(
    'keywords-' + avg.month + '.csv',
    "Keyword,Score\n" + _.chain(avg.data.split(', '))
      .map(function(keyword){
        return keyword.replace(/,/, '').replace(/ \(/, ',').replace(/\)/, '');
      })
      .value()
      .join("\n")
  );
});

